pipeline {
  agent any
  environment {
    SCANNER_HOME= tool 'sonar'
  }
  stages {
    stage('Static Code Analysis') {
      steps {
        sh '''
        echo "${SCANNER_HOME}"
        '''
        withSonarQubeEnv('SonarCloud') {
        sh 'cd ./cidr_convert_api/python/'
        sh '${SCANNER_HOME}/bin/sonar-scanner'
            }
        }
      }
      stage('Unit Test') {
      /*   agent {
                docker {
                  image 'python' 
                }
            }   */
         steps {  
           echo 'Unit testing'
           sh ''' python3 --version
           cd ./cidr_convert_api/python/
           pip install -r requirements.txt
           python3 tests.py '''
         }
      }
      stage('lint') {
      steps { 
             sh '''
             cd ./cidr_convert_api/python/
             pylint .
             '''
      }
    stage('build') {
      steps { 
             echo 'echo3'
      }
    } 
  }
}
